<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    
</body>
<script>
// Phương thức filter tạo ra một bản sao không đầy đủ của 
// 1 mảng cho sẵn , lọc qua các phần tử đã cho chỉ 
// trả về những phần tử vượt qua bài test của hàm 

// Vi dụ 1  lọc qua những phần tử có độ dài lớn hơn 6 : 

const words = ['spray', 'limit', 'elite', 'exuberant', 'destruction', 'present'];


const result = words.filter(function(word,index){
    console.log(index + " "+ word);
    return word.length > 6;
})
console.log(result);

console.log("...................................")
console.log("...................................")
console.log("...................................")

//  lọc ra mảng những phần tử có id là số 
console.log("...................................")
console.log(" lọc ra mảng những phần tử có id là số "); 
console.log("...................................")
console.log("...................................")
console.log("...................................")
console.log("...................................")

const arr = [
  { id: 15 },
  { id: -1 },
  { id: 0 },
  { id: 3 },
  { id: 12.2 },
  {},
  { id: null },
  { id: NaN },
  { id: "undefined" },
];

let invalidEntries = 0 ; 

function filterByID(item) {
  if (Number.isFinite(item.id) && item.id !== 0) {
    return true;
  }
  invalidEntries++;
  return false;
}

const arrByID = arr.filter(filterByID);

console.log("Filtered Array  ",arrByID);

console.log("Number of invalid entries "+invalidEntries);
console.log("...................................")
console.log("...................................")
console.log("...................................")
console.log("...................................")


console.log("Following example uses filter() to filter array content based on search criteria")

const fruits = ["apple", "banana", "grapes", "mango", "orange"];


function filterItem(arr,query){

    return arr.filter((el)=> el.toLowerCase().includes(query.toLowerCase()));
}

console.log("thong tin filter ");

console.log(filterItem(fruits,"ap"))


console.log("Affecting initial Array ");

console.log("The following example tests the behavior ò the filter method "+  
"when the array is modified");

// let word1s = ["spray", "limit", "exuberant", "destruction", "elite", "present"];

const modifiedWords  = words.filter((word,index,arr) => {
    arr.push("new");
    return word.length < 6;
})

console.log(modifiedWords);


//  sử dụng map() khi muốn chỉnh sửa từng phần tử của array 
console.log("...................................")
console.log("...................................")
console.log("...................................")


let  courses = [{id: 1 , name: 'java', coin:12}
,{id: 2 , name: 'C', coin:11}
,{id: 3 , name: 'C++', coin:10}
,{id: 4 , name: 'javascript', coin:9}
,{id: 5 , name: '', coin:8}]

// var newCourses = courses.map(() => {});




var sports = [
    {
        name: 'Bơi lội',
        gold: 11
    },
    {
        name: 'Boxing',
        gold: 3
    },
    {
        name: 'Đạp xe',
        gold: 4
    },
    {
        name: 'Đấu kiếm',
        gold: 5
    },
]
//  tính tổng số gold của mảng 

let sum  = sports.reduce(function(acc,currentValue){
    return acc + currentValue.gold;
},0);
console.log("giá trị  value "+sum);

function getTotalGold(arr){
    console.log(arr);
  return   arr.reduce(function(accumulator, currentValue){
        return accumulator + currentValue.gold;
    },0);
}

// Expected results:
console.log(getTotalGold(sports)) // Output: 23

console.log("...................................")
console.log("...................................")
console.log("...................................")

console.log("deepArray");
console.log("...................................")
console.log("...................................")

var deepArray = [1,2,[3,4],5, [21,32,32,1,[323,32,32,1,[32,23,12]]] ,6,[7,8,9 ] ];
var flatArray = [];
deepArray.forEach(element => {
        if(Array.isArray(element)){
            element.forEach(e => {
                    flatArray.push(e);
            })
        }
        else{
            flatArray.push(element);
        }
});


console.log(flatArray);
console.log("...................................")
console.log("...................................")

//  làm phẳng mảng sử dụng reduce  javascript 

var  flatReduceArray = deepArray.reduce(function(flatOutput, currentOutput){
    return flatOutput.concat(currentOutput);
},[]);
console.log(flatReduceArray);


// lấy ra các khóa học đưa vào 1 mảng mới 

var topics  = [
    {
        topic:"Front-end",
        courses: [
            {
                id:1,
                title:"HTML,CSS"
            },
            {
                id:2,
                title:"javascript"
            }            
        ]        
    },
    {
        topic : "Back-end",
        courses:[
            {
                id:1,
                title:"Java"
            },
            {
                id:2,
                title:"Python"
            }
        ]
    }
]

var newCources = topics.reduce(function(cources,topic){
    return cources.concat(topic.courses);
},[]);

console.log(newCources);

var htmls = newCources.map((currentValue, index, sourceCources)=>{
    return `
    <div>
            <h2>${currentValue.id}</h2>
            <h2>${currentValue.title}</h2>
        </div>
    `;
})

console.log(htmls.join(''));








var watchList = [
  {
    "Title": "Inception",
    "Year": "2010",
    "Rated": "PG-13",
    "Released": "16 Jul 2010",
    "Runtime": "148 min",
    "Genre": "Action, Adventure, Crime",
    "Director": "Christopher Nolan",
    "Writer": "Christopher Nolan",
    "Actors": "Leonardo DiCaprio, Joseph Gordon-Levitt, Elliot Page, Tom Hardy",
    "Plot": "A thief, who steals corporate secrets through use of dream-sharing technology, is given the inverse task of planting an idea into the mind of a CEO.",
    "Language": "English, Japanese, French",
    "Country": "USA, UK",
    "imdbRating": "8.8",
    "imdbVotes": "1,446,708",
    "imdbID": "tt1375666",
    "Type": "movie",
  },
  {
    "Title": "Interstellar",
    "Year": "2014",
    "Rated": "PG-13",
    "Released": "07 Nov 2014",
    "Runtime": "169 min",
    "Genre": "Adventure, Drama, Sci-Fi",
    "Director": "Christopher Nolan",
    "Writer": "Jonathan Nolan, Christopher Nolan",
    "Actors": "Ellen Burstyn, Matthew McConaughey, Mackenzie Foy, John Lithgow",
    "Plot": "A team of explorers travel through a wormhole in space in an attempt to ensure humanity's survival.",
    "Language": "English",
    "Country": "USA, UK",
    "imdbRating": "8.6",
    "imdbVotes": "910,366",
    "imdbID": "tt0816692",
    "Type": "movie",
  },
  {
    "Title": "The Dark Knight",
    "Year": "2008",
    "Rated": "PG-13",
    "Released": "18 Jul 2008",
    "Runtime": "152 min",
    "Genre": "Action, Adventure, Crime",
    "Director": "Christopher Nolan",
    "Writer": "Jonathan Nolan (screenplay), Christopher Nolan (screenplay), Christopher Nolan (story), David S. Goyer (story), Bob Kane (characters)",
    "Actors": "Christian Bale, Heath Ledger, Aaron Eckhart, Michael Caine",
    "Plot": "When the menace known as the Joker wreaks havoc and chaos on the people of Gotham, the caped crusader must come to terms with one of the greatest psychological tests of his ability to fight injustice.",
    "Language": "English, Mandarin",
    "Country": "USA, UK",
    "imdbRating": "9.0",
    "imdbVotes": "1,652,832",
    "imdbID": "tt0468569",
    "Type": "movie",
  },
  {
    "Title": "Batman Begins",
    "Year": "2005",
    "Rated": "PG-13",
    "Released": "15 Jun 2005",
    "Runtime": "140 min",
    "Genre": "Action, Adventure",
    "Director": "Christopher Nolan",
    "Writer": "Bob Kane (characters), David S. Goyer (story), Christopher Nolan (screenplay), David S. Goyer (screenplay)",
    "Actors": "Christian Bale, Michael Caine, Liam Neeson, Katie Holmes",
    "Plot": "After training with his mentor, Batman begins his fight to free crime-ridden Gotham City from the corruption that Scarecrow and the League of Shadows have cast upon it.",
    "Language": "English, Urdu, Mandarin",
    "Country": "USA, UK",
    "imdbRating": "8.3",
    "imdbVotes": "972,584",
    "imdbID": "tt0372784",
    "Type": "movie",
  },
  {
    "Title": "Avatar",
    "Year": "2009",
    "Rated": "PG-13",
    "Released": "18 Dec 2009",
    "Runtime": "162 min",
    "Genre": "Action, Adventure, Fantasy",
    "Director": "James Cameron",
    "Writer": "James Cameron",
    "Actors": "Sam Worthington, Zoe Saldana, Sigourney Weaver, Stephen Lang",
    "Plot": "A paraplegic marine dispatched to the moon Pandora on a unique mission becomes torn between following his orders and protecting the world he feels is his home.",
    "Language": "English, Spanish",
    "Country": "USA, UK",
    "imdbRating": "7.9",
    "imdbVotes": "876,575",
    "imdbID": "tt0499549",
    "Type": "movie",
  }
];

    function calculateRating(arr){
      let arrArray =  arr.filter((obj) =>{
        return obj.Director === "Christopher Nolan" ; 
      })
      console.log(arrArray);
    let total =   arrArray.reduce(function(initial, obj){
        console.log(" ini ",initial +"   ",obj.imdbRating);
        return initial + parseFloat(obj.imdbRating);
      },0.0)

      console.log(total);
      return total/arrArray.length ;
    }

// Expected results
console.log(calculateRating(watchList)); // Output: 8.675

console.log("...................................")
console.log("...................................")

<<<<<<< HEAD
//  Enhanced Object literals 

var name = 'javascript';

var price = 1000;
 var course186 = {
    name : 'Javascript',
    [price]:20000
 };
=======
// Bai  Reduce có logic như thê nào 
 
console.log("................ Bài tập công tổng ...................")

const numbers71 = [1,23,4,3,2,54,3,2];

const result71 = numbers71.reduce( (acc, current, index ) =>{
        return acc + current ;
},0);
console.log(result71);

//   chỉ truyền  callback mà không truyền initialValue 
//  nếu không truyền biến tích trữ , giá trị ban đầu là giá trị đầu tiên của mảng 


console.log("...................................")
console.log("...................................")
console.log("...............Tự tạo phương thức reduces ....................")

Array.prototype.reduce2 = function(callback , result){

    //  khởi tạo giá trị truyền vào 
    let i = 0 ; 
    if(arguments.length <2 ){
        result = this[0];
        let i = 1;
        
    }

    for(let  i = 0 ;i < this.length;i++){
        console.log("this trong function : ");
        console.log(this)
        result = callback(result, this[i],i,this);

    }
    return result;
}

const resultTest71 = numbers71.reduce2((acc, current, index) => {
            return acc + current; 
},0)

console.log(resultTest71);




//  khi mảng gọi đến hàm reduce , truyền vào 2 đối số  function callback và  initial Value 
  
//  trong function reduce   ta tạo một  vòng lặp for ,
//  số lần lặp là độ dài của mảng gọi đến hàm reduce , mỗi lần lặp gọi đến hàm callback 1 lần 
console.log("...................................")
console.log("...................................")


console.log("---------------------- Viết lại hàm reduce lần 3 ---------------- "); 




Array.prototype.reduce3 = function( callback , result){
    let i =  0 ;

    if(arguments.length < 2 ){
        result = this[0];
        i = 1 ;
    }

    for(; i < this.length ; i++ ){
            result = callback(result, this[i], i , this);
    }
    return result;
}

const resultResult371 = numbers71.reduce3((acc , current, index ) => {
    return acc + current ; 
},0)

console.log(resultResult371);


var arr71 = [
    ['name', 'Sơn Đặng'],
    ['age', 18],
];

// tạo ra object dạng   { name : "sơn đặng" , age : 18};

var arrToObject =  (arr) =>{
        return arr.reduce((acc , curent, index) =>{
            acc[curent[0]] = curent[1];
            return acc ; 
        } ,{})
}

console.log(arrToObject(arr));












>>>>>>> d58f9bcd282417a4856a6c93695c39becde30d6e

 console.log(course186)





















</script>
</html>